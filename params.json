{"name":"Drupal-ios-sdk","tagline":"The Drupal iOS iPhone & iPad Software Development Kit provides a full suite of iOS features to natively connect iOS applications to Drupal. Formerly KBDrupalConnect","body":"Drupal iOS SDK - Connect your iOS/OS X app to Drupal\r\n================================\r\n##### Originally Sponsored by [http://workhabit.com](http://workhabit.com) built by [Kyle Browning](http://kylebrowning.com)\r\nWhat you need to know\r\n================================\r\nThe Drupal iOS SDK is a standard set of libraries for communicating to Drupal from any iOS device. Its extremely simple.\r\nIf you wanted to get a node you can do so calling some class methods on DIOSNode, creating an \r\nNSDictionary and running the nodeGet method.  Heres an example:\r\n\r\n```obj-c\r\n    NSMutableDictionary *nodeData = [NSMutableDictionary new];\r\n    [nodeData setValue:@\"12\" forKey:@\"nid\"];\r\n    [DIOSNode nodeGet:nodeData success:^(AFHTTPRequestOperation *operation, id responseObject) {\r\n      //Do Something with the responseObject\r\n      NSLog(@\"%@\", responseObject);\r\n    } failure:^(AFHTTPRequestOperation *operation, NSError *error) {\r\n      //we failed, uh-oh lets error log this.\r\n      NSLog(@\"%@,  %@\", [error localizedDescription], [operation responseString]);    \r\n    }];\r\n    \r\n```\r\nFor every DIOS call you make, any method calls that are available to you use blocks. \r\nThis allows us to define what happens when we have a request that fails or succeeds. \r\nIf the request was successful the result would be something like this:\r\n\r\n    {\"vid\":\"9\",\"uid\":\"57\",\"title\":\"testtitle\",\"log\":\"\",\"status\":\"1\".......\r\n    \r\nHowever if it failed, the error might look like this:\r\n\r\n    Expected status code in (200-299), got 404,  \"Node 5 could not be found\"\r\n    \r\nWhat you need to get started\r\n================================\r\n* This library :) \r\n* AFNetwork which can be found [here](https://github.com/AFNetworking/AFNetworking)\r\n* Be sure to follow the AFNetworking installation guide.\r\n* Update Settings.h with the correct correct url and endpoints)\r\n* [Services](http://drupal.org/project/services)\r\n\r\n\r\nExtras\r\n===============================\r\n[Drupal iOS SDK Addons](https://github.com/utneon/drupal-ios-sdk-addons)\r\nDemo App (Work in progress)\r\n--------------------\r\n[http://github.com/workhabitinc/drupal-ios-sdk-example](http://github.com/workhabitinc/drupal-ios-sdk-example)\r\n\r\nBranches\r\n--------------------\r\n6.x-2.x 6.x-3.x and 7.x-3.x have all been moved to a  *DEPRECATED* version of their branch.\r\nThe new dev branch will be the become the new master and as things are added, versions will be tagged and published.\r\nmaster will always be the latest and greatest for the most up to date version of everything(Services, Drupal, Services Api, DIOS).\r\n\r\nTags are in this format\r\n`2.1-1.0` Which breaks down as, DIOSVersion 2.1, Services Api Version 1.0\r\n\r\nBranches are in this format\r\n`2.x-1.x`\r\n\r\nOAuth\r\n--------------------\r\nIf you want to use oAuth theres only one thing you need to do for 2-legged\r\n```obj-c\r\n  [DIOSSession sharedOauthSessionWithURL:@\"http://d7.workhabit.com\" consumerKey:@\"yTkyapFEPAdjkW7G2euvJHhmmsURaYJP\" secret:@\"ZzJymFtvgCbXwFeEhivtF67M5Pcj4NwJ\"];\r\n```\r\nThis will create your shared session with the baseURL and attach your consumer key and secret.\r\n\r\n3-legged requires that you get some request tokens, and convert them into access tokens.\r\nDIOS provides methods to do this, as an Example, this code will grab some request tokens and load a webview to be displayed\r\n\r\n```obj-c\r\n  [DIOSSession getRequestTokensWithSuccess:^(AFHTTPRequestOperation *operation, id responseObject) {\r\n    requestTokens = [NSMutableDictionary new];\r\n    NSArray *arr = [operation.responseString componentsSeparatedByCharactersInSet:\r\n                    [NSCharacterSet characterSetWithCharactersInString:@\"=&\"]];\r\n    if([arr count] == 4) {\r\n      [requestTokens setObject:[arr objectAtIndex:1] forKey:[arr objectAtIndex:0]];\r\n      [requestTokens setObject:[arr objectAtIndex:3] forKey:[arr objectAtIndex:2]];\r\n    } else {\r\n      NSLog(@\"failed ahh\");\r\n    }\r\n    [_window addSubview:oauthWebView];\r\n    NSString *urlToLoad = [NSString stringWithFormat:@\"%@/oauth/authorize?%@\", [[DIOSSession sharedSession] baseURL], operation.responseString];\r\n    NSURL *url = [NSURL URLWithString:urlToLoad];\r\n    NSLog(@\"loading url :%@\", urlToLoad);\r\n    //URL Requst Object\r\n    NSURLRequest *requestObj = [NSURLRequest requestWithURL:url];\r\n\r\n    //Load the request in the UIWebView.\r\n    [oauthWebView loadRequest:requestObj];\r\n  } failure:^(AFHTTPRequestOperation *operation, NSError *error) {\r\n    NSLog(@\"failed\");\r\n  }];\r\n```\r\n\r\nIf you want to get back a notificaiton when the request tokens have been authorized youll need to register a URL\r\nfor your application and make sure it is defined in your oAuth consumer which you created on your Drupal website\r\n\r\nAgain, another example here, we registered our app url and this method gets called when it does.\r\n\r\n```obj-c\r\n- (BOOL)application:(UIApplication *)application handleOpenURL:(NSURL *)url\r\n{\r\n  //If our request tokens were validated, this will get called.\r\n  if ([[url absoluteString] rangeOfString:[requestTokens objectForKey:@\"oauth_token\"]].location != NSNotFound) {\r\n    [DIOSSession getAccessTokensWithRequestTokens:requestTokens success:^(AFHTTPRequestOperation *operation, id responseObject) {\r\n      NSArray *arr = [operation.responseString componentsSeparatedByCharactersInSet:\r\n                      [NSCharacterSet characterSetWithCharactersInString:@\"=&\"]];\r\n      if([arr count] == 4) {\r\n        //Lets set our access tokens now\r\n        [[DIOSSession sharedSession] setAccessToken:[arr objectAtIndex:1] secret:[arr objectAtIndex:3]];\r\n        NSDictionary *node = [NSDictionary dictionaryWithObject:@\"1\" forKey:@\"nid\"];\r\n        [DIOSNode nodeGet:node success:^(AFHTTPRequestOperation *operation, id responseObject) {\r\n          NSLog(@\"%@\", responseObject);\r\n        } failure:^(AFHTTPRequestOperation *operation, NSError *error) {\r\n          NSLog(@\"%@\", [error localizedDescription]);\r\n        }];\r\n      } else {\r\n        NSLog(@\"failed ahh\");\r\n      }\r\n      NSLog(@\"successfully added accessTokens\");\r\n      [oauthWebView removeFromSuperview];\r\n    } failure:^(AFHTTPRequestOperation *operation, NSError *error) {\r\n        NSLog(@\"getting access tokens failed\");\r\n      [oauthWebView removeFromSuperview];\r\n    }];\r\n  }\r\n  return YES;\r\n}\r\n```\r\nDocumentation\r\n-----------\r\n[Can be found here](https://github.com/workhabitinc/drupal-ios-sdk/wiki/drupal-ios-sdk-2.0)\r\n\r\nTroubleshooting\r\n----------\r\nIf you are getting Access denied, or API Key not valid, double check that your key settings are setup correctly at admin/build/services/keys and double check that permissions are correct for your user and anonymous.\r\n\r\nX service doesnt exist in Drupal iOS SDK\r\n----------\r\nYou no longer really need to subclass any existing DIOS classes, unless you want to override.\r\n`[DIOSSession shared]` ensures that session information is stored for as long as the cookies are valid\r\nIf you do want to make your own object, just follow the pattern in the other files and everything should work fine.\r\nUse the issue queue here on github if you have questions. An addon library is [here](https://github.com/utneon/drupal-ios-sdk-addons)\r\n\r\nQuestions\r\n----------\r\nCheckout the Issue queue, or email me\r\nEmail kylebrowning@me.com","google":"UA-3203637-9","note":"Don't delete this file! It's used internally to help with page regeneration."}